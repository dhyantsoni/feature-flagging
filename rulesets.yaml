# Feature Flag Rulesets Configuration
#
# Each ruleset defines how features should be evaluated for different environments,
# user segments, or testing scenarios.

# Production Ruleset - Conservative rollout with baseline fallback
production:
  type: percentage
  kill_switch_active: false
  baseline:
    feature1_recommendations: false
    feature2_enhanced_notifications: false
    feature3_advanced_analytics: false
  features:
    feature1_recommendations:
      enabled: true
      percentage: 25  # Roll out to 25% of users
    feature2_enhanced_notifications:
      enabled: true
      percentage: 50  # Roll out to 50% of users
    feature3_advanced_analytics:
      enabled: false  # Not yet ready for production

# Staging Ruleset - Full feature access for testing
staging:
  type: percentage
  kill_switch_active: false
  baseline:
    feature1_recommendations: false
    feature2_enhanced_notifications: false
    feature3_advanced_analytics: false
  features:
    feature1_recommendations:
      enabled: true
      percentage: 100
    feature2_enhanced_notifications:
      enabled: true
      percentage: 100
    feature3_advanced_analytics:
      enabled: true
      percentage: 100

# Development Ruleset - All features enabled
development:
  type: percentage
  kill_switch_active: false
  baseline:
    feature1_recommendations: true
    feature2_enhanced_notifications: true
    feature3_advanced_analytics: true
  features:
    feature1_recommendations:
      enabled: true
      percentage: 100
    feature2_enhanced_notifications:
      enabled: true
      percentage: 100
    feature3_advanced_analytics:
      enabled: true
      percentage: 100

# A/B Test Ruleset - Testing new recommendation engine
ab_test_recommendations:
  type: ab_test
  kill_switch_active: false
  baseline:
    feature1_recommendations: false
    feature2_enhanced_notifications: false
    feature3_advanced_analytics: false
  features:
    feature1_recommendations:
      enabled: true
      groups: ["control", "treatment"]
      treatment_groups: ["treatment"]
    feature2_enhanced_notifications:
      enabled: true
      percentage: 100  # Everyone gets enhanced notifications
    feature3_advanced_analytics:
      enabled: false

# User Targeting Ruleset - Beta testers and power users
beta_testers:
  type: user_targeting
  kill_switch_active: false
  baseline:
    feature1_recommendations: false
    feature2_enhanced_notifications: false
    feature3_advanced_analytics: false
  features:
    feature1_recommendations:
      enabled: true
      whitelist: [123, 456, 789]  # Specific user IDs
      target_attributes:
        tier: ["premium", "enterprise"]
        beta_tester: true
    feature2_enhanced_notifications:
      enabled: true
      percentage: 100
    feature3_advanced_analytics:
      enabled: true
      whitelist: [123, 456]
      target_attributes:
        tier: ["enterprise"]

# Emergency Ruleset - All features disabled (kill switch demonstration)
emergency:
  type: percentage
  kill_switch_active: true
  baseline:
    feature1_recommendations: false
    feature2_enhanced_notifications: false
    feature3_advanced_analytics: false
  features:
    feature1_recommendations:
      enabled: false
    feature2_enhanced_notifications:
      enabled: false
    feature3_advanced_analytics:
      enabled: false

# Gradual Rollout Ruleset - Slowly increasing percentage
gradual_rollout:
  type: percentage
  kill_switch_active: false
  baseline:
    feature1_recommendations: false
    feature2_enhanced_notifications: false
    feature3_advanced_analytics: false
  features:
    feature1_recommendations:
      enabled: true
      percentage: 10  # Start with 10%
    feature2_enhanced_notifications:
      enabled: true
      percentage: 30
    feature3_advanced_analytics:
      enabled: true
      percentage: 5

# Custom Baseline Ruleset - Different baselines for different features
custom_baseline:
  type: percentage
  kill_switch_active: false
  baseline:
    feature1_recommendations: true   # Baseline is old recommendation system
    feature2_enhanced_notifications: false  # Baseline is no notifications
    feature3_advanced_analytics: false
  features:
    feature1_recommendations:
      enabled: true
      percentage: 50  # 50% get new system, 50% fall back to old system
    feature2_enhanced_notifications:
      enabled: true
      percentage: 75
    feature3_advanced_analytics:
      enabled: true
      percentage: 25
